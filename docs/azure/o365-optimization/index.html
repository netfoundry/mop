
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../../images/fav.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-4.6.3" name="generator"/>
<title>MS Office 365 Optimize - QuickStart Guides</title>
<link href="../../assets/stylesheets/application.adb8469c.css" rel="stylesheet"/>
<script src="../../assets/javascripts/modernizr.86422ebf.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,400i,700%7CUbuntu+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Ubuntu","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
<link href="../../assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="../../extra.css" rel="stylesheet"/>
</head>
<body dir="ltr">
<svg class="md-svg">
<defs>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#overview" tabindex="0">
        Skip to content
      </a>
<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Application header -->
<header class="md-header" data-md-component="header">
<!-- Top-level navigation -->
<nav class="md-header-nav md-grid">
<div class="md-flex">
<!-- Link to home -->
<div class="md-flex__cell md-flex__cell--shrink">
<a aria-label="QuickStart Guides" class="md-header-nav__button md-logo" href="../.." title="QuickStart Guides">
<img alt="logo" height="24" src="../../images/wide_logo.png" width="24"/>
</a>
</div>
<!-- Button to toggle drawer -->
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<!-- Header title -->
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
                QuickStart Guides
              </span>
<span class="md-header-nav__topic">
                
                  MS Office 365 Optimize
                
              </span>
</div>
<span class="md-footer-meta md-typeset">
<div class="md-footer-social">
<link href="../../assets/fonts/font-awesome.css" rel="stylesheet"/>
<a class="md-footer-social__link fa fa-github" href="https://github.com/netfoundry" rel="noopener" target="_blank" title="github"></a>
<a class="md-footer-social__link fa fa-twitter" href="https://twitter.com/netfoundry" rel="noopener" target="_blank" title="twitter"></a>
<a class="md-footer-social__link fa fa-linkedin" href="https://linkedin.com/company/netfoundry" rel="noopener" target="_blank" title="linkedin"></a>
</div>
</span>
</div>
<!-- Button to open search dialogue -->
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<!-- Search interface -->
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-icon md-search__icon" for="__search"></label>
<button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</div>
<!-- Repository containing source -->
</div>
</nav>
</header>
<div class="md-container">
<nav class="md-tabs md-tabs--active" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
        Home
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../netfoundry/intro/">
          NetFoundry Basics
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../aws/intro/">
          Cloud Providers
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../hypervisor/overview/">
          HyperVisors
        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../api/overview/">
          API
        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="../.." title="QuickStart Guides">
<img alt="logo" height="48" src="../../images/wide_logo.png" width="48"/>
</a>
    QuickStart Guides
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="Home">
      Home
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      NetFoundry Basics
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-2">
        NetFoundry Basics
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../netfoundry/intro/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../netfoundry/fabric/" title="NF Fabric">
      NF Fabric
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../netfoundry/client/" title="NF Clients">
      NF Clients
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../netfoundry/gateway/" title="NF Gateways">
      NF Gateways
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Cloud Providers
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-3">
        Cloud Providers
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" id="nav-3-1" type="checkbox"/>
<label class="md-nav__link" for="nav-3-1">
      AWS
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-1">
        AWS
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../aws/intro/" title="Use Case Overview">
      Use Case Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../aws/aws-bastion/" title="Bastion Replacement Removal">
      Bastion Replacement Removal
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" id="nav-3-2" type="checkbox"/>
<label class="md-nav__link" for="nav-3-2">
      Azure
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-2">
        Azure
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../intro/" title="Use Cases Overview">
      Use Cases Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../accessing-azure-stack/" title="Accessing Azure Stack">
      Accessing Azure Stack
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../azure-bastion/" title="Bastion Replacement Removal">
      Bastion Replacement Removal
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../connectApp2App/" title="Branch Application To Cloud Application Connectivity">
      Branch Application To Cloud Application Connectivity
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../connectUser2App/" title="Mobile User To Cloud Application Connectivity">
      Mobile User To Cloud Application Connectivity
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        MS Office 365 Optimize
      </label>
<a class="md-nav__link md-nav__link--active" href="./" title="MS Office 365 Optimize">
      MS Office 365 Optimize
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
    Overview
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#find_the_closest_front_door">
    Find the Closest Front Door
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#through_nf_web_console_ui">
    Through NF Web Console UI
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#create_and_deploy_nf_azure_gateway">
    Create and Deploy NF Azure Gateway
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_ip_network_service">
    Create IP Network Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_appwan">
    Create AppWan
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_and_install_nf_client">
    Create and install NF Client
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#programmatically">
    Programmatically
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#create_via_python_and_terraform">
    Create via Python and Terraform
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_windows_client_via_powershell">
    Create Windows Client via Powershell
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance_testing">
    Performance Testing
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#programmatically_1">
    Programmatically
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#delete_via_python_and_terraform">
    Delete via Python and Terraform
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-3" id="nav-3-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3-3">
      GCP
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-3">
        GCP
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../gcp/intro/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../gcp/getting-started/" title="Getting Started Guide">
      Getting Started Guide
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-4" id="nav-3-4" type="checkbox"/>
<label class="md-nav__link" for="nav-3-4">
      AliCloud
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-4">
        AliCloud
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../alicloud/intro/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../alicloud/getting-started/" title="Getting Started Guide">
      Getting Started Guide
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../alicloud/user-guild/" title="User Guide">
      User Guide
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-5" id="nav-3-5" type="checkbox"/>
<label class="md-nav__link" for="nav-3-5">
      VCPE
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-3-5">
        VCPE
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../vcpe/intro/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../vcpe/cpe-automation/" title="CPE Automation">
      CPE Automation
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" id="nav-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4">
      HyperVisors
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-4">
        HyperVisors
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hypervisor/overview/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" id="nav-4-2" type="checkbox"/>
<label class="md-nav__link" for="nav-4-2">
      Hyper-V
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-4-2">
        Hyper-V
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hypervisor/hyper-v/getting-started/" title="Getting Started">
      Getting Started
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" id="nav-4-3" type="checkbox"/>
<label class="md-nav__link" for="nav-4-3">
      KVM
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-4-3">
        KVM
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hypervisor/kvm/getting-started/" title="Getting Started">
      Getting Started
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-4" id="nav-4-4" type="checkbox"/>
<label class="md-nav__link" for="nav-4-4">
      VMware
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-4-4">
        VMware
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hypervisor/vmware/getting-started/" title="Getting Started">
      Getting Started
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" id="nav-4-5" type="checkbox"/>
<label class="md-nav__link" for="nav-4-5">
      VirtualBox
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-4-5">
        VirtualBox
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../hypervisor/virtualbox/getting-started/" title="Getting Started">
      Getting Started
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/>
<label class="md-nav__link" for="nav-5">
      API
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-5">
        API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/overview/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" id="nav-5-2" type="checkbox"/>
<label class="md-nav__link" for="nav-5-2">
      Powershell
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-2">
        Powershell
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/powershell/overview/" title="Overview">
      Overview
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/powershell/getting-started/" title="Getting Started">
      Getting Started
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-3" id="nav-5-3" type="checkbox"/>
<label class="md-nav__link" for="nav-5-3">
      Python
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-3">
        Python
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/python/overview/" title="Overview">
      Overview
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-4" id="nav-5-4" type="checkbox"/>
<label class="md-nav__link" for="nav-5-4">
      Bash
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-4">
        Bash
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/bash/overview/" title="Overview">
      Overview
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#overview">
    Overview
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#find_the_closest_front_door">
    Find the Closest Front Door
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#through_nf_web_console_ui">
    Through NF Web Console UI
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#create_and_deploy_nf_azure_gateway">
    Create and Deploy NF Azure Gateway
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_ip_network_service">
    Create IP Network Service
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_appwan">
    Create AppWan
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_and_install_nf_client">
    Create and install NF Client
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#programmatically">
    Programmatically
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#create_via_python_and_terraform">
    Create via Python and Terraform
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#create_windows_client_via_powershell">
    Create Windows Client via Powershell
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance_testing">
    Performance Testing
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#programmatically_1">
    Programmatically
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#delete_via_python_and_terraform">
    Delete via Python and Terraform
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset"><a class="md-icon md-content__icon" download href="o365-optimization.pdf" title="PDF Export"></a>
<h1>MS Office 365 Optimize</h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">@</a></h2>
<p>We will guide users how to deploy a NF Gateway to optimize the connectivity
to Microsoft O365 Services. The services that will be optimized are
share-point and one-drive</p>
<p>Microsoft deployed content delivery network (CDN), where they offer many entry points around the World to access Office
365 Services like sharepoint, onedrive, etc. By providing these "front doors" (also known as) to O365 services, MS wanted to improve user experience by optimizing reach-ability and access. With that in mind, Microsoft is pushing Enterprises to utilize this CDN by creating O365 bypass at the edge of the Enterprise Network. The bypass is a configuration change, where a policy routing is enforced to allow the 0365 services to be short circuited to the Internet. The idea is to avoid going through a central location, where all content is inspected and checked for security threats before released to World Wide Web.</p>
<p>NetFoundry Edge has the ability to provide such bypass if desired, but in this Quickstart we are showing how our customers can configure NF Network to complement the MS CDN, utilize their optimization and still keep using NF Secure tunnels for connectivity.</p>
<h3 id="find_the_closest_front_door">Find the Closest Front Door<a class="headerlink" href="#find_the_closest_front_door" title="Permanent link">@</a></h3>
<p>Microsoft created an online tool to test from user's location, where the best entry to their Network is. Please open a browser on your windows computer and type the following url https://connectivity.office.com/.</p>
<p>As it is stated there, click on the location icon. Once the test is finished, it will show where the closest location is.</p>
<p><img alt="Image" src="../../images/office-connectivity-tool-01.png"/></p>
<p><img alt="Image" src="../../images/office-connectivity-tool-02.png"/></p>
<p>In our example, the user's closest location is Ashburn, VA (Azure USEAST).</p>
<div class="admonition note">
<p class="admonition-title">Select Region</p>
<p>Make sure you replace "Your Region" with the location of Azure DC given
by the location tool.</p>
<p>Most of the time, our Orchestration Platform will optimize the network to provide direct connectivity from where you are and Azure GW you are about to create.
We will test if that is the case. We continuously update our optimization algorithm to pick the best path all the time based on ongoing data collection and feedback from the network fabric.</p>
</div>
<h3 id="through_nf_web_console_ui">Through NF Web Console UI<a class="headerlink" href="#through_nf_web_console_ui" title="Permanent link">@</a></h3>
<h4 id="create_and_deploy_nf_azure_gateway">Create and Deploy NF Azure Gateway<a class="headerlink" href="#create_and_deploy_nf_azure_gateway" title="Permanent link">@</a></h4>
<p>This section will guide a user through the steps on how to create a NF Manage Gateway in the NF Console UI and install it in the Azure vNet.</p>
<div class="admonition example">
<p class="admonition-title">Console UI</p>
<ol>
<li>Navigate to Manage Gateways Page</li>
<li>Click on + sign in the top right corner.
<img alt="Image" src="../../images/CreateManagedGatewayAzure01.png"/></li>
<li>Click on "Create Gateway" on the Azure Cloud Gateway Card
<img alt="Image" src="../../images/CreateManagedGatewayAzure02.png"/></li>
<li>Fill in the required information and click on "Create"
<img alt="Image" src="../../images/CreateManagedGatewayAzure03.png"/></li>
<li>Copy the Client Registration Key
<img alt="Image" src="../../images/CreateManagedGatewayAzure04.png"/></li>
<li>Click on "Deploy to Microsoft Azure". It will take you to the Azure Portal and ask you for your login credentials.</li>
<li>You will be presented with the template that needs to be filled. The first section is the Basics regarding your Subscription and Resource Group this gateway will be deployed in.
<img alt="Image" src="../../images/CreateManagedGatewayAzure05.png"/></li>
<li>The second section related to resources associated with this gateway. e.g. vm name, ip address space, security groups, etc. you will paste the registration key copied in step 5. You will also need the public ssh key to use for access to this gateway remotely.
<img alt="Image" src="../../images/CreateManagedGatewayAzure06.png"/></li>
<li>You will need to agree to Azure Marketplace Terms and Conditions and click to "Purchase" to continue.
<img alt="Image" src="../../images/CreateManagedGatewayAzure07.png"/></li>
<li>If the NF Gateway was deployed successfully. Here is the view of the Resource Group and NF Conole UI.
<img alt="Image" src="../../images/CreateManagedGatewayAzure08.png"/>
<img alt="Image" src="../../images/CreateManagedGatewayAzure09.png"/></li>
<li>Done</li>
</ol>
</div>
<div class="admonition note">
<p class="admonition-title">Create SharePoint &amp; OneDrive Services</p>
<p>Once can find the ip address that are allocated by Microsoft for SharePoint and OneDrive service.
<a href="https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges#sharepoint-online-and-onedrive-for-business">Click on this link and write them down</a></p>
<p>We only required  to use "Optimize Required" (ID 31), and they are 13.107.136.0/22, 40.108.128.0/17, 52.104.0.0/14, 104.146.128.0/17, 150.171.40.0/22.
Create 5 services by repeating the next section for each of them. Replace Network Address in Step 4 with the ones above and Intercept Ports with 80, 443.</p>
</div>
<h4 id="create_ip_network_service">Create IP Network Service<a class="headerlink" href="#create_ip_network_service" title="Permanent link">@</a></h4>
<p>This section will guide a user through the steps on how to create a NF Service.</p>
<div class="admonition example">
<p class="admonition-title">Console UI</p>
<ol>
<li>Navigate to Manage Services Page under Manage Appwans</li>
<li>Click on + sign in the top right corner.
<img alt="Image" src="../../images/CreateService01.png"/></li>
<li>Click on "Create an IP Network Service"
<img alt="Image" src="../../images/CreateService03.png"/></li>
<li>
<p>Fill in the required information for the Network your wanting to access.
<img alt="Image" src="../../images/CreateIpNetworkService.png"/></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please make sure the service you want to access is behind the gateway you specify here.</p>
</div>
</li>
<li>
<p>If successfully, the service is green.
<img alt="Image" src="../../images/CreateService05.png"/></p>
</li>
<li>Done</li>
</ol>
</div>
<p>All services configured.</p>
<p><img alt="Image" src="../../images/CreateServiceO365SharePointOneDrive.png"/></p>
<h4 id="create_appwan">Create AppWan<a class="headerlink" href="#create_appwan" title="Permanent link">@</a></h4>
<p>This section will guide a user through the steps on how to enable service connectivity to users by creating an appwan.</p>
<div class="admonition example">
<p class="admonition-title">Console UI</p>
<ol>
<li>Navigate to Manage AppWANS Page under Manage Appwans</li>
<li>Click on + sign in the top right corner.
<img alt="Image" src="../../images/CreateAppWan01.png"/></li>
<li>Click on "Component Builder Appwan"
<img alt="Image" src="../../images/CreateAppWan02.png"/></li>
<li>Move the desired gateway (e.g. DemoGateway01) from "Available" Gateways to "Selected" Endpoints. Move the desired service (e.g. DemoServiceSsh) from "Available" to "Selected" Services.
<img alt="Image" src="../../images/BranchGW2AzureGWappWanServiceSsh.png"/></li>
<li>Click on "Create".
<img alt="Image" src="../../images/BranchGW2AzureGWappWanServiceSshResult.png"/></li>
<li>Done</li>
</ol>
</div>
<p>AppWan successfully configured would look like this.</p>
<p><img alt="Image" src="../../images/CreateAppWanO365SharePointOneDrive.png"/></p>
<h4 id="create_and_install_nf_client">Create and install NF Client<a class="headerlink" href="#create_and_install_nf_client" title="Permanent link">@</a></h4>
<p>This section will guide a user through the steps on how to create a client in the NF Console UI. Then, it will provide links to Guides on how to install the NetFoundry Client Software for Windows and MAC Clients, including the registration with the  NF Network Fabric.</p>
<div class="admonition example">
<p class="admonition-title">Console UI</p>
<ol>
<li>Navigate to Manage Clients Page
<img alt="Image" src="../../images/CreateManagedClient01.png"/></li>
<li>Click on + sign in the top right corner.</li>
<li>Fill in the required information and click on "Create"
<img alt="Image" src="../../images/CreateManagedClient02.png"/></li>
<li>Copy the Client Registration Key
<img alt="Image" src="../../images/CreateManagedClient03.png"/></li>
<li>Install the NF Client Software by following the directions at the appropriate OS link<ol>
<li><a href="https://support.netfoundry.io/hc/en-us/articles/360017535332-Install-a-NetFoundry-Client-on-Windows">Window</a></li>
<li><a href="https://support.netfoundry.io/hc/en-us/articles/360016128692-Install-a-NetFoundry-Client-on-MacOS">Mac</a></li>
</ol>
</li>
<li>Add this Endpoint to the AppWan</li>
<li>Once endpoint is added to the AppWan, here is what the services tab should look like.
<img alt="Image" src="../../images/EndpointServiceView-O365.png"/></li>
</ol>
</div>
<h3 id="programmatically">Programmatically<a class="headerlink" href="#programmatically" title="Permanent link">@</a></h3>
<h4 id="create_via_python_and_terraform">Create via Python and Terraform<a class="headerlink" href="#create_via_python_and_terraform" title="Permanent link">@</a></h4>
<div class="admonition note">
<p class="admonition-title">Python Modules</p>
<p>For the code clarity, we have broken down the code into multiple Python modules  </p>
<ol>
<li><a href="../../api/python/source/netfoundry/nf_requests.py">NF REST CRUD (Create,Read, Update and Delete) operations</a></li>
<li><a href="../../api/python/source/netfoundry/nf_token.py">Get MOP Session Token</a></li>
<li><a href="../../api/python/source/netfoundry/nf_network.py">Create NF Network</a></li>
<li><a href="../../api/python/source/netfoundry/nf_gateway.py">Create NF Gateway(s)</a></li>
<li><a href="../../api/python/source/netfoundry/nf_service.py">Create NF Service(s)</a></li>
<li><a href="../../api/python/source/netfoundry/nf_appwan.py">Create NF AppWan(s)</a></li>
<li><a href="../../api/python/source/netfoundry/nf_resources.py">Wrapper Script to Create NF Resources based on Resource yaml file</a></li>
</ol>
</div>
<div class="admonition note">
<p class="admonition-title">Environment Setup Requirements</p>
<ol>
<li>
<p><a href="../../api/python/etc/env">~/.env</a> to store NF Credentials in (e.g. <code>clientId, clientSecret</code>) to obtain a session token for NF API</p>
</li>
<li>
<p>Export Azure Credentials (e.g, <code>export ARM_TENANT_ID, ARM_CLIENT_ID, ARM_CLIENT_SECRET, ARM_SUBSCRIPTION_ID</code>) to enable resource gateway creation in Azure Resource Group via Terraform.</p>
</li>
<li>Terraform and Python3 installed in path.</li>
</ol>
<p>Additional Information:</p>
<ol>
<li>The new Resource Group in Azure is created based on then name provided in <a href="../../api/python/etc/nf_resources.yml">Resource yml</a>, if one does not exist already in the same region (e.g. centralus). The action delete gateway will delete the RG as well even if it was an existing RG. If one does not want to delete the RG, the command <code>terraform state rm "{tf resource name for RG}"</code> needs to be run before running the gateway delete step. This will ensure that the RG is not deleted.</li>
<li>A new vNet will be created and NF Gateway will be placed in it.</li>
<li>Environment means the NF Console Environment used (e.g. production), not Azure.</li>
</ol>
</div>
<div class="admonition example">
<p class="admonition-title">Steps</p>
<ol>
<li>Clone this repo (git clone https://github.com/netfoundry/mop.git)</li>
<li>Change directory to mop: <code>cd mop</code></li>
<li>Update <code>quickstarts/docs/api/python/etc/nf_resources.yml</code> as so:
<div class="highlight"><pre><span></span><code><span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">network_action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
<span class="nt">network_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NetworkO365</span>
<span class="nt">gateway_list</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">cloud</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">azure</span>
  <span class="nt">count</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">names</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">region</span><span class="p">:</span> <span class="s">"region</span><span class="nv"> </span><span class="s">found</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">connectivity</span><span class="nv"> </span><span class="s">test,</span><span class="nv"> </span><span class="s">e.g.</span><span class="nv"> </span><span class="s">eastus"</span>
  <span class="nt">regionalCidr</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">10.20.10.0/24</span>
  <span class="nt">regkeys</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
  <span class="nt">resourceGroup</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="s">"you</span><span class="nv"> </span><span class="s">resource</span><span class="nv"> </span><span class="s">RG</span><span class="nv"> </span><span class="s">Name"</span>
    <span class="nt">region</span><span class="p">:</span> <span class="s">"region</span><span class="nv"> </span><span class="s">of</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">RG"</span>
  <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">services</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive01</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">22</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">13.107.136.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive02</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">17</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">40.108.128.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive03</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">14</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">52.104.0.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive04</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">17</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">104.146.128.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive05</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">22</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">150.171.40.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="nt">appwans</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">endpoints</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AppWanSharepoint</span>
  <span class="nt">services</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive01</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive02</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive03</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive04</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive05</span>
<span class="nt">terraform</span><span class="p">:</span>
  <span class="nt">bin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">terraform</span>
  <span class="nt">output</span><span class="p">:</span> <span class="s">'no'</span>
  <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./quickstarts/docs/terraform</span>
  <span class="nt">work_dir</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
</code></pre></div></li>
<li>Run this from the root folder (mop) to create network, gateway, services, and appwan throuhg NF API
and deploy Virtual Machine to host NF Gateway in your Azure RG.
<div class="highlight"><pre><span></span><code><span class="n">python3</span> <span class="n">quickstarts</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">netfoundry</span><span class="o">/</span><span class="n">nf_resources</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">file</span> <span class="n">quickstarts</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nf_resources</span><span class="o">.</span><span class="n">yml</span>
</code></pre></div></li>
<li>Run this command if to keep RG (replace "RG Region" with your RG's region, e.g. centralus)
<div class="highlight"><pre><span></span><code>terraform state rm module."RG Region"_rg.azurerm_resource_group.terraformgroup
</code></pre></div></li>
<li>Once the script is finished, all the resources in NF Console and Azure RG will have been deployed.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If something went wrong, please check logoutput.txt file generated in the root directory for details on any errors that may have occurred during the deployment.</p>
</div>
</div>
<h4 id="create_windows_client_via_powershell">Create Windows Client via Powershell<a class="headerlink" href="#create_windows_client_via_powershell" title="Permanent link">@</a></h4>
<p>This section provides the powershell code to spin up a NF client with the name as computer name fetched by PS script.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<ol>
<li>Here are the parameters used in the script few needs to be changed to suit your need for eg. network_name and region_ name.
<div class="highlight"><pre><span></span><code><span class="nt">clientId /secret</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">from NF console steps below.</span>
<span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Production</span>
<span class="nt">network_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">e.g. DemoNet01</span>
<span class="nt">audience</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">URI for the Auth0</span>
<span class="nt">api_endpoint</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">URI for the API calls</span>
<span class="nt">region_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The region_name is the reference region or location where client will be created</span>
            <span class="l l-Scalar l-Scalar-Plain">(reference closest AWS location) e.g.us-east-1</span>
<span class="nt">provider</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWS</span>
</code></pre></div></li>
<li>To create a unique client we can use second half of computer name below powershell cmdlet will fetch the same.
<div class="highlight"><pre><span></span><code><span class="c">#Set Endpoint name to second half of computer name:</span>
<span class="nv">$endpoint_name</span> <span class="p">=</span> <span class="nv">$ENV:COMPUTERNAME</span><span class="p">.</span><span class="n">Split</span><span class="p">(</span><span class="s2">"-"</span><span class="p">)[-</span><span class="n">1</span><span class="p">]</span>
</code></pre></div></li>
<li>This section creates an access token by an api call using parameters defined earlier.
<div class="highlight"><pre><span></span><code><span class="c"># Get a auth token from Auth0</span>
<span class="nv">$auth_payload</span> <span class="p">=</span> <span class="p">@{</span>
    <span class="n">client_id</span><span class="p">=</span><span class="nv">$client_id</span>
    <span class="n">client_secret</span><span class="p">=</span><span class="nv">$client_secret</span>
    <span class="n">audience</span><span class="p">=</span><span class="nv">$audience</span>
    <span class="n">grant_type</span><span class="p">=</span><span class="s1">'client_credentials'</span>
<span class="p">}</span>
<span class="nv">$auth_json</span> <span class="p">=</span> <span class="nv">$auth_payload</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>

<span class="nv">$post_uri</span> <span class="p">=</span>  <span class="s2">"https://netfoundry-"</span> <span class="p">+</span> <span class="nv">$environment</span> <span class="p">+</span> <span class="s2">".auth0.com/oauth/token"</span>

<span class="nv">$auth0_response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-Uri</span> <span class="nv">$post_uri</span> <span class="n">-ContentType</span> <span class="s1">'application/json'</span> <span class="n">-Body</span> <span class="nv">$auth_json</span>

<span class="nv">$token</span> <span class="p">=</span> <span class="nv">$auth0_response</span><span class="p">.</span><span class="n">access_token</span>

<span class="c">#Inserting auth token to headers for API calls</span>
<span class="nv">$headers</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="s2">"System.Collections.Generic.Dictionary[[String],[String]]"</span>
<span class="nv">$headers</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="s2">"Authorization"</span><span class="p">,</span> <span class="p">(</span><span class="s2">"Bearer "</span> <span class="p">+</span> <span class="nv">$token</span><span class="p">))</span>
</code></pre></div></li>
<li>This is how to get datacenterId and networkId which basically makes an API call to strips off unwanted information.
This information will be used to create client later.
<div class="highlight"><pre><span></span><code><span class="c"># Get a dataCenter ID:</span>

<span class="nv">$datacenter_uri</span> <span class="p">=</span> <span class="nv">$api_endpoint</span> <span class="p">+</span> <span class="s2">"/dataCenters"</span>

<span class="nv">$dataCenter_response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Method</span> <span class="n">Get</span> <span class="n">-Uri</span> <span class="nv">$datacenter_uri</span> <span class="n">-ContentType</span> <span class="s1">'application/json'</span> <span class="n">-Headers</span> <span class="nv">$headers</span>

<span class="nv">$dataCenter</span> <span class="p">=</span> <span class="nv">$dataCenter_response</span><span class="p">.</span><span class="n">_embedded</span><span class="p">.</span><span class="n">dataCenters</span> <span class="p">|</span> <span class="nb">where </span><span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">locationCode</span> <span class="o">-like</span> <span class="nv">$region_name</span> <span class="o">-and</span> <span class="nv">$_</span><span class="p">.</span><span class="n">provider</span> <span class="o">-like</span> <span class="nv">$provider</span> <span class="p">}</span>  <span class="p">|</span> <span class="nb">select </span><span class="n">_links</span>

<span class="nv">$dataCenterId</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$dataCenter</span><span class="p">.</span><span class="n">_links</span><span class="p">.</span><span class="n">self</span><span class="p">.</span><span class="n">href</span><span class="p">).</span><span class="n">Split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)[-</span><span class="n">1</span><span class="p">]</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c"># Get a Network ID:</span>

<span class="nv">$network_uri</span> <span class="p">=</span> <span class="nv">$api_endpoint</span> <span class="p">+</span> <span class="s2">"/networks"</span>

<span class="nv">$network_response</span> <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Method</span> <span class="n">Get</span> <span class="n">-Uri</span> <span class="nv">$network_uri</span> <span class="n">-ContentType</span> <span class="s1">'application/json'</span> <span class="n">-Headers</span> <span class="nv">$headers</span>

<span class="nv">$network</span> <span class="p">=</span> <span class="nv">$network_response</span><span class="p">.</span><span class="n">_embedded</span><span class="p">.</span><span class="n">networks</span> <span class="p">|</span> <span class="nb">where </span><span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">name</span> <span class="o">-like</span> <span class="nv">$network_name</span> <span class="p">}</span> <span class="p">|</span> <span class="nb">select </span><span class="n">_links</span>

<span class="nv">$networkrId</span> <span class="p">=</span> <span class="p">(</span><span class="nv">$network</span><span class="p">.</span><span class="n">_links</span><span class="p">.</span><span class="n">self</span><span class="p">.</span><span class="n">href</span><span class="p">).</span><span class="n">Split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)[-</span><span class="n">1</span><span class="p">]</span>
</code></pre></div></li>
<li>Below section of the script uses computername, networkId and datacenterId from above sections to make API call create a NF client and fetch the regitration key.
<div class="highlight"><pre><span></span><code><span class="c"># Create an Endpoint &amp; get reg key</span>
<span class="nv">$endpoint_uri</span> <span class="p">=</span> <span class="nv">$api_endpoint</span> <span class="p">+</span> <span class="s2">"/networks/"</span> <span class="p">+</span> <span class="nv">$networkrId</span> <span class="p">+</span> <span class="s2">"/endpoints"</span>
<span class="nv">$endpoint_payload</span>  <span class="p">=</span> <span class="p">@{</span>
    <span class="n">name</span> <span class="p">=</span> <span class="nv">$endpoint_name</span>
    <span class="n">endpointType</span> <span class="p">=</span> <span class="s2">"CL"</span>
    <span class="n">dataCenterId</span> <span class="p">=</span> <span class="nv">$dataCenterId</span>
<span class="p">}</span>
<span class="nv">$endpoint_json</span> <span class="p">=</span> <span class="nv">$endpoint_payload</span> <span class="p">|</span> <span class="nb">ConvertTo-Json</span>
<span class="nv">$endpoint_response</span>  <span class="p">=</span> <span class="nb">Invoke-RestMethod</span> <span class="n">-Method</span> <span class="n">Post</span> <span class="n">-Uri</span> <span class="nv">$endpoint_uri</span> <span class="n">-ContentType</span> <span class="s1">'application/json'</span> <span class="n">-Body</span> <span class="nv">$endpoint_json</span> <span class="n">-Headers</span> <span class="nv">$headers</span>
<span class="nv">$endpoint_registration_key</span> <span class="p">=</span> <span class="nv">$endpoint_response</span><span class="p">.</span><span class="n">registrationKey</span>
</code></pre></div></li>
<li>This section will run a registration script silently to register the NF client.
<div class="highlight"><pre><span></span><code><span class="c"># Run registration script</span>
<span class="nb">Start-Process</span> <span class="n">-FilePath</span> <span class="n">C</span><span class="err">:</span><span class="p">\</span><span class="s2">"Program Files"</span><span class="p">\</span><span class="n">DVN</span><span class="p">\</span><span class="n">vtc_app</span><span class="p">\</span><span class="n">nfnreg</span> <span class="nv">$endpoint_registration_key</span>
</code></pre></div></li>
<li>Once you download <a href="../../api/powershell/source-code/NF-pwrshell.ps1">PS script</a> onto your laptop and update it with your network details, run the following in the directory containing the script:
<div class="highlight"><pre><span></span><code>.\NF-pwrshell.ps1
</code></pre></div></li>
<li>Update the following section of the resources.yaml file referenced at the beginning of the last section.
<div class="highlight"><pre><span></span><code><span class="nt">appwans</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">create</span>
  <span class="nt">endpoints</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="s">"your</span><span class="nv"> </span><span class="s">endpoint</span><span class="nv"> </span><span class="s">name"</span>
</code></pre></div></li>
<li>Run resources.py script to add the newly created endpoint to the same AppWan.
<div class="highlight"><pre><span></span><code><span class="n">python3</span> <span class="n">quickstarts</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">netfoundry</span><span class="o">/</span><span class="n">nf_resources</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">file</span> <span class="n">quickstarts</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nf_resources</span><span class="o">.</span><span class="n">yml</span>
</code></pre></div></li>
<li>Once endpoint is added to the AppWan, here is what the services tab should look like.
<img alt="Image" src="../../images/EndpointServiceView-O365.png"/></li>
</ol>
</div>
<h3 id="performance_testing">Performance Testing<a class="headerlink" href="#performance_testing" title="Permanent link">@</a></h3>
<div class="admonition example">
<p class="admonition-title">Verifying the performance through testing</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Recommended way of accessing Ondrive is through the Windows App with File Explorer. If access to OneDrive is required using a browser than Firefox is recommended by NetFoundry to get best performance.</p>
</div>
<ol>
<li>Map your Business OneDrive to your local file system if not already done so.</li>
<li>Make sure the NF App is enabled.</li>
<li>Transfer large files between remote and local drive to test the performance.</li>
<li>Disable the NF App and repeat the previous step to compare the performance.</li>
<li>The performance should be at least the same if not better.</li>
</ol>
</div>
<h3 id="programmatically_1">Programmatically<a class="headerlink" href="#programmatically_1" title="Permanent link">@</a></h3>
<h4 id="delete_via_python_and_terraform">Delete via Python and Terraform<a class="headerlink" href="#delete_via_python_and_terraform" title="Permanent link">@</a></h4>
<div class="admonition example">
<p class="admonition-title">Steps</p>
<ol>
<li>Change all actions to delete in <code>quickstarts/docs/api/python/etc/nf_resources.yml</code> as so:
<div class="highlight"><pre><span></span><code><span class="nt">environment</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">production</span>
<span class="nt">network_action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
<span class="nt">network_name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">NetworkO365</span>
<span class="nt">gateway_list</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">cloud</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">azure</span>
  <span class="nt">count</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">1</span>
  <span class="nt">names</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">eastus</span>
  <span class="nt">regionalCidr</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">10.20.10.0/24</span>
  <span class="nt">regkeys</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
  <span class="nt">resourceGroup</span><span class="p">:</span>
    <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">RG_O365_Demo</span>
    <span class="nt">region</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">centralus</span>
  <span class="nt">tag</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">services</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive01</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">22</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">13.107.136.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive02</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">17</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">40.108.128.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive03</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">14</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">52.104.0.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive04</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">17</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">104.146.128.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">gateway</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">GATEWAY-O365-01</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive05</span>
  <span class="nt">netCidr</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">22</span>
  <span class="nt">netIp</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">150.171.40.0</span>
  <span class="nt">type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">network</span>
<span class="nt">appwans</span><span class="p">:</span>
<span class="p p-Indicator">-</span> <span class="nt">action</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">delete</span>
  <span class="nt">endpoints</span><span class="p">:</span> <span class="p p-Indicator">[]</span>
  <span class="nt">name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AppWanSharepoint</span>
  <span class="nt">services</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive01</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive02</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive03</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive04</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">SharePointOneDrive05</span>
<span class="nt">terraform</span><span class="p">:</span>
  <span class="nt">bin</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">terraform</span>
  <span class="nt">output</span><span class="p">:</span> <span class="s">'no'</span>
  <span class="nt">source</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">./quickstarts/docs/terraform</span>
  <span class="nt">work_dir</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">.</span>
</code></pre></div></li>
<li>Run this from the root folder (mop) to delete network, gateway, services, and appwan through NF API
and destroy Virtual Machine hosting NF Gateway in your Azure RG.
<div class="highlight"><pre><span></span><code><span class="n">python3</span> <span class="n">quickstarts</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">source</span><span class="o">/</span><span class="n">netfoundry</span><span class="o">/</span><span class="n">nf_resources</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">file</span> <span class="n">quickstarts</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">nf_resources</span><span class="o">.</span><span class="n">yml</span>
</code></pre></div></li>
</ol>
</div>
</article>
</div>
</div>
</main>
<!--
  Copyright (c) 2016-2020 Martin Donath <martin.donath@squidfunk.com>
  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:
  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.
  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->
<!-- Application footer -->
<footer class="md-footer">
<!-- Link to previous and/or next page -->
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<!-- Link to previous page -->
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../connectUser2App/" rel="prev" title="Mobile User To Cloud Application Connectivity">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Mobile User To Cloud Application Connectivity
              </span>
</div>
</a>
<!-- Link to next page -->
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../../gcp/intro/" rel="next" title="Overview">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<!-- Further information -->
</footer></div>
</body></html>

<script src="../../assets/javascripts/application.c33a9706.js"></script>
<script>app.initialize({version:"1.1",url:{base:"../.."}})</script>

